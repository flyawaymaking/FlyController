# FlyController

FlyController — умная система временного полёта с интеграцией CoinsEngine. Игроки покупают полёт за внутриигровую валюту, получая доступ к полёту в разрешённых мирах. Система автоматически сохраняет оставшееся время при выходе, смене мира или в бою.

---

## Возможности

- Настраиваемая система уровней полёта через config.yml
- Интеграция с CoinsEngine для экономических транзакций
- Автоматическое сохранение времени при выходе/смене мира/в бою
- Автоматическое восстановление полёта при входе на сервер
- ActionBar с таймером оставшегося времени полёта
- Ограничение использования полёта только разрешёнными мирами
- Настраиваемые скорости полёта через config.yml
- Защита от конфликтов с Essentials
- Команда перезагрузки конфигурации без перезапуска сервера

---

## Конфигурация (config.yml)

```
# Настройки валюты
currency: "money"

# Миры где разрешён полёт (список)
worlds:
  - "world"

# Перезарядка после использования полёта (в миллисекундах)
cooldown: 600000

# Уровни полёта
flight-tiers:
  1:
    cost: 50000
    duration: 120
  2:
    cost: 100000  
    duration: 300
  3:
    cost: 200000
    duration: 600

# Скорости полёта (значения от 0.0 до 1.0)
fly-speeds:
  1: 0.1
  2: 0.2
  3: 0.4
```

---

## Команды и права

### Основные команды для игроков

```
/mfly info - информация о балансе и уровнях полёта
/mfly deposit <сумма> - внести деньги на счёт полётов
/mfly activate - активировать полёт (максимальный доступный уровень)
/mfly continue - продолжить сохранённый полёт
/flyspeed <скорость> - установить скорость полёта
```

### Команды для администраторов

```
/mfly reload - перезагрузить конфигурацию
```

### Права доступа

```
flyplugin.mfly - доступ к системе полётов (/mfly)
flyplugin.flyspeed - доступ к команде /flyspeed  
flyplugin.admin - доступ к команде перезагрузки конфига
```

---

## Особенности работы

### Автоматическое сохранение
- При выходе из сервера - полёт ставится на паузу
- При смене мира (не разрешённый) - полёт ставится на паузу
- При вступлении в PvP-бой - полёт отключается с сохранением времени

### Автоматическое восстановление
- При входе на сервер - полёт автоматически восстанавливается
- Сохранённое время переживает перезагрузки сервера

### Ограничения
- Полёт работает только в разрешённых мирах из config.yml
- В PvP-бою полёт автоматически отключается
- Скорость полёта настраивается через config.yml

---

## Пример использования

```
1. Игрок вносит деньги: /mfly deposit 50000
2. Активирует полёт: /mfly activate
3. Видит в ActionBar: ⏰ 1:59 осталось полёта
4. При выходе из мира: "Полёт отключён! Оставшееся время сохранено"
5. При возвращении для продолжения полёта: /mfly continue
6. Устанавливает скорость: /flyspeed 2
```

---

## Настройка

### Добавление новых уровней полёта
Отредактируйте `flight-tiers` в config.yml:
```
flight-tiers:
  1:
    cost: 50000
    duration: 120
  2:
    cost: 100000
    duration: 300
  3:
    cost: 200000
    duration: 600
  4:
    cost: 500000
    duration: 1200
```

### Добавление новых скоростей
Отредактируйте `fly-speeds` в config.yml:
```
fly-speeds:
  1: 0.05
  2: 0.1
  3: 0.2
  4: 0.4
  5: 0.8
```

### Добавление новых миров
Отредактируйте `worlds` в config.yml:
```
worlds:
  - "world"
  - "world_nether"
  - "world_the_end"
  - "my_custom_world"
```

---

## Совместимость

- **Обязательно**: [CoinsEngine](https://github.com/nulli0n/CoinsEngine-spigot) (для экономики)
- **Рекомендуется**: EssentialsX (для базового полёта)
- **Поддержка**: Paper 1.21.8, Java 21

---

## Установка

1. Убедитесь, что установлен CoinsEngine
2. Скачайте **последний релиз** из раздела [Releases](../../releases)
3. Поместите .jar файл в папку /plugins
4. Перезапустите сервер
5. Настройте config.yml под свои нужды
6. Используйте /mfly reload для применения изменений

---

## Примечания

- Полёт в креативе не отключается автоматически
- При отключении плагина полёт сохраняется и восстанавливается
- Система защищена от конфликтов с Essentials
- Все транзакции логируются для отладки
- Конфигурация применяется мгновенно через /mfly reload
